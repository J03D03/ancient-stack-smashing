"""
Challenge 3: Overwrite the EIP register

TEMPLATE
"""

from pwn import *

context.update(arch='i386', os='linux')
pty = process.PTY
elf = context.binary = ELF("./binaries/binary-3-no-protection")
p = process(elf.path)

print(p.recvline())

print("Craft payload")
address_of_secret_function = 0x00000  # TODO: FIND THE ADDRESS
offset_eip = 0  # TODO: FIND THE CORRECT OFFSET FOR EIP
payload = b'A'*offset_eip + p32(address_of_secret_function)

print("Send payload")
p.sendline(payload)

print("Receive output")
print(p.recvline())
