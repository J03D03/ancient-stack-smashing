"""
Challenge 2: Overwrite the pin

TEMPLATE
"""

from pwn import *

context.update(arch='i386', os='linux')
pty = process.PTY
elf = context.binary = ELF("./binaries/binary-2-no-protection")
p = process(elf.path)

# GDB SETUP (does not work within the Dockerfile):
# TODO: replace `urxvt` with your terminal
# context.terminal = ['urxvt', '-e', 'sh', '-c']
# gdb.attach(p, """
# b *0x8049258
# c
# x/4x $esp
# """)

print(p.recvline())

print("Craft payload")
payload = b'AAAA'  # TODO: CRAFT YOUR PAYLOAD

print("Send payload")
print("\t" + str(payload))
p.sendline(payload)

print("Receive output")
print("\t" + str(p.recvline()))
